<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é‡£é­šå†’éšª indev-250325</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: Arial, sans-serif;
            background-color: #87CEEB;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            display: grid;
            grid-template-columns: 3fr 1fr;
            gap: 20px;
        }
        .game-area {
            background-color: #fff;
            border-radius: 10px;
            padding: 20px;
            position: relative;
            min-height: 400px;
        }
        .fishing-spot {
            width: 100%;
            height: 300px;
            background: linear-gradient(0deg, #0a4da8 0%, #1e65c7 40%, #2e8cb8 100%);
            border-radius: 5px;
            position: relative;
            overflow: hidden;
            cursor: pointer;
            position: relative;
            box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.2);
            z-index: 5; /* ç¢ºä¿é‡£é­šå€åŸŸæœ‰é©ç•¶çš„z-index */
        }
        
        .fishing-spot::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 200%;
            height: 100%;
            background: linear-gradient(90deg, rgba(255,255,255,0.05) 0%, rgba(255,255,255,0.2) 50%, rgba(255,255,255,0.05) 100%);
            animation: wave 8s linear infinite;
            z-index: 1;
        }
        
        .fishing-spot::after {
            content: '';
            position: absolute;
            top: 40%;
            left: -50%;
            width: 200%;
            height: 60%;
            background: linear-gradient(90deg, rgba(255,255,255,0.05) 0%, rgba(255,255,255,0.15) 50%, rgba(255,255,255,0.05) 100%);
            animation: wave 10s linear infinite reverse;
            z-index: 2;
        }
        
        /* æ·»åŠ ç¬¬ä¸‰å±¤æ³¢æµª */
        .fishing-spot .wave3 {
            content: '';
            position: absolute;
            top: 60%;
            left: -30%;
            width: 200%;
            height: 40%;
            background: linear-gradient(90deg, rgba(255,255,255,0.02) 0%, rgba(255,255,255,0.1) 50%, rgba(255,255,255,0.02) 100%);
            animation: wave 6s linear infinite;
            z-index: 3;
        }
        
        /* æ·»åŠ æ°´é¢åå…‰æ•ˆæœ */
        .fishing-spot .reflection {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(ellipse at center, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 70%);
            opacity: 0.5;
            animation: reflection 5s ease-in-out infinite alternate;
            z-index: 4;
        }
        
        @keyframes wave {
            0% { transform: translateX(0); }
            100% { transform: translateX(-50%); }
        }
        
        @keyframes reflection {
            0% { opacity: 0.3; transform: scale(1); }
            100% { opacity: 0.6; transform: scale(1.1); }
        }
        
        /* æ·»åŠ é¡å¤–çš„æ³¢æµªæ•ˆæœ */
        .fishing-spot::before, .fishing-spot::after, .fishing-spot .wave3 {
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.1);
        }
        .progress-container {
            width: 80%;
            height: 30px;
            background-color: #ddd;
            border-radius: 15px;
            margin: 10px auto;
            display: none;
            position: relative;
            box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.2);
            border: 1px solid #ccc;
            overflow: hidden;
            z-index: 2000; /* å¢åŠ z-indexç¢ºä¿é€²åº¦æ¢é¡¯ç¤ºåœ¨æœ€ä¸Šå±¤ */
            opacity: 1 !important;
            visibility: visible !important; /* ç¢ºä¿å¯è¦‹æ€§ */
            pointer-events: auto !important; /* ç¢ºä¿å¯ä»¥æ¥æ”¶é»æ“Šäº‹ä»¶ */
        }
        
        .progress-bar {
            width: 0%;
            height: 100%;
            background: linear-gradient(to right, #4CAF50, #8BC34A);
            border-radius: 15px;
            transition: width 0.1s;
            position: relative;
            box-shadow: 0 0 5px rgba(76, 175, 80, 0.5);
            display: block; /* ç¢ºä¿é€²åº¦æ¢å§‹çµ‚é¡¯ç¤º */
            opacity: 1;
        }
        
        .progress-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(to bottom, 
                        rgba(255, 255, 255, 0.3) 0%, 
                        rgba(255, 255, 255, 0.1) 50%, 
                        rgba(255, 255, 255, 0) 51%, 
                        rgba(255, 255, 255, 0) 100%);
        }
        .fish-animation {
            position: absolute;
            width: 50px;
            height: 30px;
            background-color: orange;
            border-radius: 50% 70% 70% 50%;
            display: none;
            z-index: 15;
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.3);
            animation: swim 2s ease-in-out infinite;
            overflow: hidden;
            pointer-events: none; /* ç¢ºä¿é­šçš„å‹•ç•«ä¸æœƒé˜»æ“‹é»æ“Šäº‹ä»¶ */
        }
        
        .fish-animation::before { /* é­šé°­ */
            content: '';
            position: absolute;
            top: 10px;
            right: 5px;
            width: 15px;
            height: 15px;
            background-color: rgba(255, 165, 0, 0.8);
            border-radius: 50% 0 50% 0;
            transform: rotate(45deg);
        }
        
        .fish-animation::after { /* é­šçœ¼ */
            content: '';
            position: absolute;
            top: 8px;
            left: 10px;
            width: 6px;
            height: 6px;
            background-color: black;
            border-radius: 50%;
            box-shadow: 0 0 2px 1px white;
        }
        
        @keyframes swim {
            0% { transform: translateX(0) rotate(0deg); }
            25% { transform: translateX(5px) rotate(2deg); }
            50% { transform: translateY(3px); }
            75% { transform: translateX(-5px) rotate(-2deg); }
            100% { transform: translateX(0) rotate(0deg); }
        }
        .rod-button {
            position: absolute;
            width: 60px;
            height: 60px;
            background: radial-gradient(circle at 30% 30%, #b67f4e, #8B4513);
            border-radius: 50%;
            display: none;
            cursor: pointer;
            animation: shake 0.5s infinite;
            color: white;
            font-weight: bold;
            text-align: center;
            line-height: 60px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5), inset 0 0 5px rgba(255, 255, 255, 0.3);
            border: 2px solid #6d3300;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.7);
            transition: transform 0.1s, box-shadow 0.1s;
            z-index: 3000; /* å¢åŠ z-indexç¢ºä¿é‡£ç«¿æŒ‰éˆ•é¡¯ç¤ºåœ¨æœ€ä¸Šå±¤ */
            pointer-events: auto !important; /* ç¢ºä¿å¯ä»¥æ¥æ”¶é»æ“Šäº‹ä»¶ */
        }
        
        .rod-button:hover {
            transform: scale(1.05);
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.6), inset 0 0 8px rgba(255, 255, 255, 0.4);
        }
        
        @keyframes shake {
            0% { transform: translate(0, 0) rotate(0deg); }
            25% { transform: translate(2px, 2px) rotate(2deg); }
            50% { transform: translate(0, 0) rotate(0deg); }
            75% { transform: translate(-2px, 2px) rotate(-2deg); }
            100% { transform: translate(0, 0) rotate(0deg); }
        }
        .sidebar {
            background-color: #fff;
            border-radius: 10px;
            padding: 20px;
        }
        .inventory {
            margin-bottom: 20px;
        }
        .stats {
            margin-bottom: 20px;
        }
        .shop-button, .map-button, .fish-button {
            width: 100%;
            padding: 10px;
            margin: 5px 0;
            background: linear-gradient(to bottom, #4CAF50, #45a049);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            transition: all 0.2s ease;
        }
        
        .shop-button:hover, .map-button:hover, .fish-button:hover {
            background: linear-gradient(to bottom, #45a049, #3d8b3d);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            transform: translateY(-2px);
        }
        
        .shop-button:active, .map-button:active, .fish-button:active {
            transform: translateY(1px);
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
        }
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            z-index: 5000;
            opacity: 0;
            transition: opacity 0.3s ease;
            /* æ·»åŠ flexboxä½ˆå±€å¯¦ç¾å®Œç¾ç½®ä¸­ */
            justify-content: center;
            align-items: center;
            pointer-events: none; /* åˆå§‹ç‹€æ…‹ä¸‹ä¸æ¥æ”¶é»æ“Šäº‹ä»¶ */
        }
        
        .modal.show {
            opacity: 1;
            display: flex; /* ç¢ºä¿é¡¯ç¤ºæ™‚ä¹Ÿä½¿ç”¨flexbox */
            pointer-events: auto; /* é¡¯ç¤ºæ™‚æ¥æ”¶é»æ“Šäº‹ä»¶ */
        }
        
        .modal-content {
            background-color: #fff;
            padding: 20px;
            border-radius: 10px;
            width: 80%;
            max-width: 600px;
            position: relative;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            transform: translateY(-20px);
            opacity: 0;
            transition: all 0.3s ease;
            /* ç§»é™¤marginè¨­å®šï¼Œç”±flexboxæ§åˆ¶ç½®ä¸­ */
            pointer-events: auto; /* ç¢ºä¿å¯ä»¥æ¥æ”¶é»æ“Šäº‹ä»¶ */
            z-index: 5001; /* ç¢ºä¿å…§å®¹åœ¨æ¨¡æ…‹æ¡†ä¹‹ä¸Š */
        }
        
        .modal.show .modal-content {
            transform: translateY(0);
            opacity: 1;
        }
        
        .modal h2 {
            color: #2e8cb8;
            border-bottom: 2px solid #eee;
            padding-bottom: 10px;
            margin-bottom: 15px;
        }
        
        .modal button {
            background: linear-gradient(to bottom, #4CAF50, #45a049);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 15px;
            font-weight: bold;
            transition: all 0.2s ease;
        }
        
        .modal button:hover {
            background: linear-gradient(to bottom, #45a049, #3d8b3d);
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="game-area">
            <div class="fishing-spot" id="fishingSpot">
                <!-- é‡£é­šå‹•ç•«å’Œé­šæœƒåœ¨é€™è£¡é¡¯ç¤º -->
                <div class="wave3"></div>
                <div class="reflection"></div>
                <div class="fish-animation" id="fishAnimation"></div>
                <div class="rod-button" id="rodButton">é‡£ç«¿</div>
            </div>
            <div class="progress-container" id="progressContainer">
                <div class="progress-bar" id="progressBar"></div>
            </div>
            <button class="fish-button" onclick="startFishing()" style="z-index: 50; position: relative;">é–‹å§‹é‡£é­š</button>
        </div>
        <div class="sidebar">
            <div class="stats">
                <h3>ç‹€æ…‹</h3>
                <p>é‡‘éŒ¢: <span id="money">100</span></p>
                <p>ç•¶å‰é‡£ç«¿: <span id="currentRod">åˆç´šé‡£ç«¿</span></p>
            </div>
            <div class="inventory">
                <h3>èƒŒåŒ…</h3>
                <div id="inventoryList"></div>
            </div>
            <button class="shop-button" onclick="openShop()" style="z-index: 50; position: relative;">å•†åº—</button>
            <button class="map-button" onclick="openMap()" style="z-index: 50; position: relative;">åœ°åœ–</button>
        </div>
    </div>

    <!-- å•†åº—å½ˆçª— -->
    <div id="shopModal" class="modal">
        <div class="modal-content">
            <h2>å•†åº—</h2>
            <div id="shopItems"></div>
            <span onclick="closeShop()" style="position: absolute; top: 10px; right: 15px; color: red; cursor: pointer; font-weight: bold;">X</span>
        </div>
    </div>

    <!-- åœ°åœ–å½ˆçª— -->
    <div id="mapModal" class="modal">
        <div class="modal-content">
            <h2>æ¢ç´¢åœ°åœ– <span style="font-size: 0.8em; color: #4CAF50;">(é‡‘éŒ¢: <span id="mapModalMoney">0</span>)</span></h2>
            <div id="mapLocations"></div>
            <span onclick="closeMap()" style="position: absolute; top: 10px; right: 15px; color: red; cursor: pointer; font-weight: bold;">X</span>
        </div>
    </div>

    <script>
        // éŠæˆ²æ•¸æ“š - è¨­ç‚ºå…¨å±€è®Šé‡
        window.gameData = {
            money: 100,
            currentRod: {
                name: "åˆç´šé‡£ç«¿",
                power: 1,
                price: 0
            },
            inventory: [],
            currentLocation: "æ·ºç˜",
            version: "indev-250325" // ç‰ˆæœ¬è™Ÿ
        };

        // é‡£ç«¿å•†åº—æ•¸æ“š
        const rods = [
            { name: "ä¸­ç´šé‡£ç«¿", power: 2, price: 200 },
            { name: "é«˜ç´šé‡£ç«¿", power: 3, price: 500 },
            { name: "å°ˆæ¥­é‡£ç«¿", power: 4, price: 1000 },
            { name: "ç¢³çº–ç¶­é‡£ç«¿", power: 5, price: 2000 },
            { name: "é‘½çŸ³é‡£ç«¿", power: 7, price: 5000 },
            { name: "å‚³èªªé‡£ç«¿", power: 10, price: 10000 }
        ];

        // é­šé¡æ•¸æ“š
        const fishes = {
            æ·ºç˜: [
                { name: "å°é¯‰é­š", price: 10, chance: 0.7 },
                { name: "æ²³è±š", price: 20, chance: 0.3 }
            ],
            æ·±æµ·: [
                { name: "é‡‘æ§é­š", price: 50, chance: 0.4 },
                { name: "é¯Šé­š", price: 100, chance: 0.1 }
            ],
            çŠç‘šç¤: [
                { name: "ç†±å¸¶é­š", price: 30, chance: 0.6 },
                { name: "ç« é­š", price: 80, chance: 0.2 }
            ],
            æ¹–æ³Š: [
                { name: "é»‘é±¸é­š", price: 25, chance: 0.5 },
                { name: "é±˜é­š", price: 70, chance: 0.3 },
                { name: "å·¨å‹é¯°é­š", price: 120, chance: 0.2 }
            ],
            æ²³æµ: [
                { name: "é±’é­š", price: 15, chance: 0.6 },
                { name: "é®­é­š", price: 40, chance: 0.3 },
                { name: "å½©è™¹é­š", price: 90, chance: 0.1 }
            ],
            æ·±æ·µ: [
                { name: "æ·±æµ·é°»", price: 150, chance: 0.4 },
                { name: "ç™¼å…‰é­š", price: 200, chance: 0.3 },
                { name: "æ·±æ·µå·¨ç¸", price: 500, chance: 0.05 },
                { name: "å¹½éˆé­š", price: 300, chance: 0.25 }
            ],
            å†°æ¹–: [
                { name: "å†°é­š", price: 60, chance: 0.5 },
                { name: "é›ªèŠ±é­š", price: 120, chance: 0.3 },
                { name: "å†°æ™¶é¾é­š", price: 350, chance: 0.2 }
            ]
        };
        
        // åœ°é»å‚³é€è²»ç”¨
        const travelCosts = {
            æ·ºç˜: 0, // åˆå§‹åœ°é»å…è²»
            æ·±æµ·: 100,
            çŠç‘šç¤: 150,
            æ¹–æ³Š: 50,
            æ²³æµ: 80,
            æ·±æ·µ: 300,
            å†°æ¹–: 200
        };

        // é‡£é­šåŠŸèƒ½
        let isFishing = false;
        let fishCaught = null;
        let progressInterval = null;
        let progressValue = 0;
        let progressDecay = 1.5; // èª¿æ•´è¡°æ¸›é€Ÿç‡ç‚º0.5ï¼Œä½¿éŠæˆ²æ›´å¹³è¡¡
        let clickPower = 8; // å¢åŠ é»æ“ŠåŠ›é‡ï¼Œå¾5æ”¹ç‚º8
        let fishingStage = 0; // 0: æœªé‡£é­š, 1: é‡£ç«¿éšæ®µ, 2: é€²åº¦æ¢éšæ®µ
        let rodTouchCount = 0; // è¨˜éŒ„ç©å®¶è§¸ç¢°é‡£ç«¿æŒ‰éˆ•çš„æ¬¡æ•¸
        let rodTouchTarget = 0; // éœ€è¦è§¸ç¢°çš„ç›®æ¨™æ¬¡æ•¸

        // é‡£é­šè¶…æ™‚è¨ˆæ™‚å™¨ID
        let fishingTimeoutId = null;
        
        function startFishing() {
            // å¦‚æœå·²ç¶“åœ¨é‡£é­šä¸­ï¼Œç›´æ¥è¿”å›
            if (isFishing) return;
            
            // ç²å–æ‰€æœ‰éœ€è¦çš„DOMå…ƒç´ 
            const fishButton = document.querySelector('.fish-button');
            const fishingSpot = document.getElementById('fishingSpot');
            const progressContainer = document.getElementById('progressContainer');
            const progressBar = document.getElementById('progressBar');
            const fishAnimation = document.getElementById('fishAnimation');
            const rodButton = document.getElementById('rodButton');
            
            console.log('é–‹å§‹é‡£é­šå‡½æ•¸è¢«èª¿ç”¨');
            
            // ç¢ºä¿åœ¨é–‹å§‹æ–°çš„é‡£é­šéç¨‹å‰æ¸…é™¤æ‰€æœ‰å¯èƒ½å­˜åœ¨çš„è¨ˆæ™‚å™¨
            if (progressInterval) {
                console.log('æ¸…é™¤ä¹‹å‰å¯èƒ½å­˜åœ¨çš„é€²åº¦æ¢è¨ˆæ™‚å™¨');
                clearInterval(progressInterval);
                progressInterval = null;
            }
            
            if (fishingTimeoutId) {
                console.log('æ¸…é™¤ä¹‹å‰å¯èƒ½å­˜åœ¨çš„é‡£é­šè¶…æ™‚è¨ˆæ™‚å™¨');
                clearTimeout(fishingTimeoutId);
                fishingTimeoutId = null;
            }
            
            // é‡ç½®æ‰€æœ‰é‡£é­šç›¸é—œç‹€æ…‹
            fishButton.disabled = true;
            fishButton.textContent = 'é‡£é­šä¸­...';
            isFishing = true;
            fishingStage = 1; // é€²å…¥é‡£ç«¿éšæ®µ
            
            // é‡ç½®è§¸ç¢°è¨ˆæ•¸å™¨ä¸¦è¨­ç½®ç›®æ¨™æ¬¡æ•¸ï¼ˆ5-10ä¹‹é–“çš„éš¨æ©Ÿæ•¸ï¼Œé™ä½é›£åº¦ï¼‰
            rodTouchCount = 0;
            rodTouchTarget = Math.floor(Math.random() * 6) + 5; // 5åˆ°10ä¹‹é–“çš„éš¨æ©Ÿæ•¸
            console.log(`é‡£ç«¿éšæ®µï¼šéœ€è¦é»æ“Š ${rodTouchTarget} æ¬¡`);
            
            // ç¬¬ä¸€éšæ®µï¼šé¡¯ç¤ºé‡£ç«¿æŒ‰éˆ•
            rodButton.style.display = 'block';
            rodButton.style.left = Math.random() * (fishingSpot.offsetWidth - 60) + 'px';
            rodButton.style.top = Math.random() * (fishingSpot.offsetHeight - 60) + 'px';
            
            // ç¢ºä¿ç§»é™¤ä¹‹å‰çš„äº‹ä»¶ç›£è½å™¨
            rodButton.onclick = null;
            fishingSpot.onclick = null;
            
            // è¨­ç½®é‡£ç«¿æŒ‰éˆ•é»æ“Šäº‹ä»¶
            rodButton.onclick = function(event) {
                if (event) {
                    event.stopPropagation(); // é˜²æ­¢äº‹ä»¶å†’æ³¡åˆ°fishingSpot
                }
                
                // ç¢ºä¿æˆ‘å€‘ä»ç„¶åœ¨é‡£ç«¿éšæ®µ
                if (fishingStage !== 1 || !isFishing) {
                    console.log('é‡£ç«¿é»æ“Šè¢«å¿½ç•¥ï¼Œç•¶å‰éšæ®µä¸æ˜¯é‡£ç«¿éšæ®µæˆ–é‡£é­šå·²åœæ­¢');
                    return;
                }
                
                // å¢åŠ è§¸ç¢°è¨ˆæ•¸
                rodTouchCount++;
                console.log(`é‡£ç«¿æŒ‰éˆ•é»æ“Š: ${rodTouchCount}/${rodTouchTarget}`);
                
                // å¦‚æœé‚„æ²’é”åˆ°ç›®æ¨™æ¬¡æ•¸ï¼Œå‰‡ç§»å‹•é‡£ç«¿æŒ‰éˆ•åˆ°æ–°ä½ç½®
                if (rodTouchCount < rodTouchTarget) {
                    rodButton.style.left = Math.random() * (fishingSpot.offsetWidth - 60) + 'px';
                    rodButton.style.top = Math.random() * (fishingSpot.offsetHeight - 60) + 'px';
                    return;
                }
                
                // é”åˆ°ç›®æ¨™æ¬¡æ•¸å¾Œï¼Œéš±è—é‡£ç«¿æŒ‰éˆ•ä¸¦é€²å…¥é€²åº¦æ¢éšæ®µ
                console.log('é”åˆ°ç›®æ¨™é»æ“Šæ¬¡æ•¸ï¼Œé€²å…¥é€²åº¦æ¢éšæ®µ');
                rodButton.style.display = 'none';
                fishingStage = 2; // é€²å…¥é€²åº¦æ¢éšæ®µ
                
                // æ¸…é™¤é‡£ç«¿éšæ®µçš„è¶…æ™‚è¨ˆæ™‚å™¨
                if (fishingTimeoutId) {
                    clearTimeout(fishingTimeoutId);
                    fishingTimeoutId = null;
                }
                
                // æª¢æŸ¥æ˜¯å¦æœ‰é­šä¸Šé‰¤
                fishCaught = checkForFish();
                console.log('é­šä¸Šé‰¤æª¢æŸ¥çµæœ:', fishCaught);
                
                if (fishCaught) {
                    try {
                        // é¡¯ç¤ºé­šçš„å‹•ç•«
                        fishAnimation.style.display = 'block';
                        fishAnimation.style.left = Math.random() * (fishingSpot.offsetWidth - 50) + 'px';
                        fishAnimation.style.top = Math.random() * (fishingSpot.offsetHeight - 30) + 'px';
                        console.log('é­šçš„å‹•ç•«å·²é¡¯ç¤º');
                        
                        // é¡¯ç¤ºé€²åº¦æ¢ - æ·»åŠ å¼·åˆ¶é‡ç¹ªæ©Ÿåˆ¶
                        progressContainer.style.display = 'block'; // ç›´æ¥é¡¯ç¤º
                        progressValue = 30; // èµ·å§‹é€²åº¦
                        progressBar.style.width = progressValue + '%';
                        // ç¢ºä¿é€²åº¦æ¢å¯è¦‹
                        progressBar.style.display = 'block';
                        console.log('é€²åº¦æ¢é¡¯ç¤ºç‹€æ…‹:', progressContainer.style.display, progressBar.style.display);
                        console.log('é€²åº¦æ¢å·²é¡¯ç¤ºï¼Œåˆå§‹é€²åº¦å€¼:', progressValue);
                        
                        // è¨­ç½®é»æ“Šäº‹ä»¶
                        fishingSpot.onclick = function() {
                            console.log('é‡£é­šå€åŸŸè¢«é»æ“Šï¼Œç•¶å‰éšæ®µ:', fishingStage);
                            if (isFishing && fishCaught && fishingStage === 2) {
                                progressValue += clickPower;
                                console.log('é€²åº¦å¢åŠ ï¼Œç•¶å‰é€²åº¦:', progressValue);
                                if (progressValue > 100) progressValue = 100;
                                progressBar.style.width = progressValue + '%';
                                
                                if (progressValue >= 100) {
                                    // é‡£é­šæˆåŠŸ
                                    console.log('é‡£é­šæˆåŠŸï¼é€²åº¦é”åˆ°100%');
                                    if (progressInterval) {
                                        clearInterval(progressInterval);
                                        progressInterval = null;
                                    }
                                    completeFishing(true);
                                }
                            }
                        };
                        
                        // è¨­ç½®é€²åº¦æ¢è¡°æ¸›
                        if (progressInterval) {
                            clearInterval(progressInterval);
                            progressInterval = null;
                        }
                        
                        progressInterval = setInterval(() => {
                            // ç¢ºä¿æˆ‘å€‘ä»ç„¶åœ¨é€²åº¦æ¢éšæ®µ
                            if (fishingStage !== 2 || !isFishing) {
                                console.log('é‡£é­šå·²åœæ­¢ï¼Œæ¸…é™¤é€²åº¦æ¢è¨ˆæ™‚å™¨');
                                clearInterval(progressInterval);
                                progressInterval = null;
                                return;
                            }
                            
                            // é€²åº¦æ¢éš¨æ™‚é–“è¡°æ¸›
                            console.log('é€²åº¦æ¢è¡°æ¸›ä¸­ï¼Œç•¶å‰é€²åº¦:', progressValue);
                            progressValue -= progressDecay; // æ¢å¾©é€²åº¦æ¢è¡°æ¸›
                            progressBar.style.width = progressValue + '%';
                            
                            // ç”±æ–¼progressDecayç‚º0ï¼Œé€²åº¦ä¸æœƒé™åˆ°0ï¼Œä½†ä¿ç•™æª¢æŸ¥é‚è¼¯ä»¥é˜²è¬ä¸€
                            if (progressValue <= 0) {
                                console.log('é€²åº¦ç‚º0ï¼Œä½†ä¸æœƒè‡ªå‹•å¤±æ•—');
                                // ä¸å†è‡ªå‹•çµæŸé‡£é­š
                                // clearInterval(progressInterval);
                                // progressInterval = null;
                                // completeFishing(false);
                            }
                        }, 100);
                        
                        // ç§»é™¤é‡£é­šè¶…æ™‚æ©Ÿåˆ¶ï¼Œè®“ç©å®¶æœ‰å……è¶³çš„æ™‚é–“é‡£é­š
                        // æ³¨æ„ï¼šåŸæœ¬çš„è¶…æ™‚è¨ˆæ™‚å™¨å·²è¢«ç§»é™¤ï¼Œç©å®¶å¯ä»¥ç„¡é™æ™‚é–“é‡£é­š
                        console.log('é€²åº¦æ¢éšæ®µé–‹å§‹ï¼Œç©å®¶å¯ä»¥ç„¡é™æ™‚é–“é‡£é­š');
                        // fishingTimeoutId è¨­ç‚º nullï¼Œç¢ºä¿ä¸æœƒæœ‰è¶…æ™‚è™•ç†
                        fishingTimeoutId = null;
                    } catch (error) {
                        console.error('é€²åº¦æ¢éšæ®µç™¼ç”ŸéŒ¯èª¤:', error);
                        resetFishing();
                    }
                } else {
                    // æ²’æœ‰é­šä¸Šé‰¤
                    setTimeout(() => {
                        gameAlert('ä»Šå¤©é‹æ°£ä¸å¥½ï¼Œæ²’æœ‰é­šä¸Šé‰¤ï¼', 'info', 'é‡£é­šçµæœ', 3000);
                        resetFishing();
                    }, 500);
                }
            };
            
            // ç§»é™¤é‡£ç«¿éšæ®µè¶…æ™‚æ©Ÿåˆ¶ï¼Œè®“ç©å®¶æœ‰å……è¶³çš„æ™‚é–“é»æ“Šé‡£ç«¿æŒ‰éˆ•
            // æ³¨æ„ï¼šåŸæœ¬çš„è¶…æ™‚è¨ˆæ™‚å™¨å·²è¢«ç§»é™¤ï¼Œç©å®¶å¯ä»¥ç„¡é™æ™‚é–“é»æ“Šé‡£ç«¿æŒ‰éˆ•
            console.log('é‡£ç«¿éšæ®µé–‹å§‹ï¼Œç©å®¶å¯ä»¥ç„¡é™æ™‚é–“é»æ“Šé‡£ç«¿æŒ‰éˆ•');
            // fishingTimeoutId è¨­ç‚º nullï¼Œç¢ºä¿ä¸æœƒæœ‰è¶…æ™‚è™•ç†
            fishingTimeoutId = null;
        }

        // æª¢æŸ¥æ˜¯å¦æœ‰é­šä¸Šé‰¤
        function checkForFish() {
            const locationFishes = fishes[gameData.currentLocation];
            // éš¨æ©Ÿé¸æ“‡ä¸€æ¢é­š
            const randomIndex = Math.floor(Math.random() * locationFishes.length);
            const selectedFish = locationFishes[randomIndex];
            
            // ç›´æ¥è¿”å›é¸ä¸­çš„é­šï¼Œç¢ºä¿100%ä¸Šé‰¤ç‡
            console.log('é­šå·²ä¸Šé‰¤ï¼š', selectedFish.name, 'ï¼Œ100%ä¸Šé‰¤ç‡å·²ç”Ÿæ•ˆ');
            return selectedFish;
        }
        
        // å®Œæˆé‡£é­š
        function completeFishing(success) {
            try {
                const fishAnimation = document.getElementById('fishAnimation');
                const progressContainer = document.getElementById('progressContainer');
                const progressBar = document.getElementById('progressBar');
                const rodButton = document.getElementById('rodButton');
                
                console.log('å®Œæˆé‡£é­šå‡½æ•¸è¢«èª¿ç”¨ï¼ŒæˆåŠŸç‹€æ…‹:', success);
                
                // ç¢ºä¿æ¸…é™¤æ‰€æœ‰è¨ˆæ™‚å™¨
                if (progressInterval) {
                    console.log('åœ¨completeFishingä¸­æ¸…é™¤é€²åº¦æ¢è¨ˆæ™‚å™¨');
                    clearInterval(progressInterval);
                    progressInterval = null;
                }
                
                if (fishingTimeoutId) {
                    console.log('åœ¨completeFishingä¸­æ¸…é™¤é‡£é­šè¶…æ™‚è¨ˆæ™‚å™¨');
                    clearTimeout(fishingTimeoutId);
                    fishingTimeoutId = null;
                }
                
                // éš±è—æ‰€æœ‰é‡£é­šç›¸é—œå…ƒç´ 
                if (fishAnimation) fishAnimation.style.display = 'none';
                if (progressContainer) progressContainer.style.display = 'none';
                if (progressBar) progressBar.style.width = '0%'; // é‡ç½®é€²åº¦æ¢å¯¬åº¦
                if (rodButton) rodButton.style.display = 'none';
                
                // è™•ç†é‡£é­šçµæœ
                if (success && fishCaught) {
                    gameData.inventory.push(fishCaught);
                    updateInventory();
                    setTimeout(() => {
                        gameAlert(`æ­å–œï¼ä½ é‡£åˆ°äº† ${fishCaught.name}ï¼`, 'success', 'é‡£é­šæˆåŠŸ', 4000);
                        
                        // è‡ªå‹•ä¿å­˜éŠæˆ²
                        if (typeof autoSaveGame === 'function') {
                            autoSaveGame();
                        }
                    }, 100);
                } else if (isFishing) { // åªæœ‰åœ¨é‡£é­šéç¨‹ä¸­æ‰é¡¯ç¤ºå¤±æ•—æ¶ˆæ¯
                    setTimeout(() => {
                        gameAlert('å¯æƒœï¼é­šè·‘æ‰äº†ï¼', 'error', 'é‡£é­šå¤±æ•—', 3000);
                    }, 100);
                }
                
                // é‡ç½®é‡£é­šç‹€æ…‹
                resetFishing();
            } catch (error) {
                console.error('å®Œæˆé‡£é­šå‡½æ•¸ç™¼ç”ŸéŒ¯èª¤:', error);
                // ç¢ºä¿å³ä½¿å‡ºéŒ¯ä¹Ÿèƒ½é‡ç½®é‡£é­šç‹€æ…‹
                resetFishing();
            }
        }
        
        // é‡ç½®é‡£é­šç‹€æ…‹
        function resetFishing() {
            try {
                const fishButton = document.querySelector('.fish-button');
                const fishingSpot = document.getElementById('fishingSpot');
                const rodButton = document.getElementById('rodButton');
                const fishAnimation = document.getElementById('fishAnimation');
                const progressContainer = document.getElementById('progressContainer');
                const progressBar = document.getElementById('progressBar');
                
                console.log('é‡ç½®é‡£é­šç‹€æ…‹');
                
                // ç¢ºä¿æ¸…é™¤æ‰€æœ‰è¨ˆæ™‚å™¨
                if (progressInterval) {
                    console.log('åœ¨resetFishingä¸­æ¸…é™¤é€²åº¦æ¢è¨ˆæ™‚å™¨');
                    clearInterval(progressInterval);
                    progressInterval = null;
                }
                
                if (fishingTimeoutId) {
                    console.log('åœ¨resetFishingä¸­æ¸…é™¤é‡£é­šè¶…æ™‚è¨ˆæ™‚å™¨');
                    clearTimeout(fishingTimeoutId);
                    fishingTimeoutId = null;
                }
                
                // é‡ç½®UIå…ƒç´ 
                if (fishButton) {
                    fishButton.disabled = false;
                    fishButton.textContent = 'é–‹å§‹é‡£é­š';
                }
                
                // æ¸…é™¤æ‰€æœ‰äº‹ä»¶è™•ç†å™¨
                if (fishingSpot) fishingSpot.onclick = null;
                if (rodButton) rodButton.onclick = null;
                
                // éš±è—æ‰€æœ‰é‡£é­šç›¸é—œå…ƒç´ 
                if (rodButton) rodButton.style.display = 'none';
                if (fishAnimation) fishAnimation.style.display = 'none';
                if (progressContainer) progressContainer.style.display = 'none';
                if (progressBar) progressBar.style.width = '0%';
                
                // é‡ç½®é‡£é­šç‹€æ…‹è®Šé‡
                isFishing = false;
                fishCaught = null;
                fishingStage = 0;
                rodTouchCount = 0;
            } catch (error) {
                console.error('é‡ç½®é‡£é­šç‹€æ…‹å‡½æ•¸ç™¼ç”ŸéŒ¯èª¤:', error);
                // æœ€å¾Œçš„å®‰å…¨æªæ–½ï¼šå¼·åˆ¶é‡ç½®åŸºæœ¬ç‹€æ…‹
                isFishing = false;
                fishingStage = 0;
                fishCaught = null;
            }
        }

        // æ›´æ–°èƒŒåŒ…é¡¯ç¤º - è¨­ç‚ºå…¨å±€å‡½æ•¸
        window.updateInventory = function() {
            const inventoryList = document.getElementById('inventoryList');
            inventoryList.innerHTML = '';
            
            // æ›´æ–°ç•¶å‰ä½ç½®é¡¯ç¤º
            document.getElementById('currentRod').textContent = gameData.currentRod.name;
            document.getElementById('money').textContent = gameData.money;
            
            // å¦‚æœèƒŒåŒ…ç‚ºç©ºï¼Œé¡¯ç¤ºæç¤ºä¿¡æ¯
            if (gameData.inventory.length === 0) {
                const emptyDiv = document.createElement('div');
                emptyDiv.textContent = 'èƒŒåŒ…æ˜¯ç©ºçš„ï¼Œå»é‡£äº›é­šå§ï¼';
                emptyDiv.style.fontStyle = 'italic';
                emptyDiv.style.color = '#888';
                inventoryList.appendChild(emptyDiv);
                return;
            }
            
            const fishCounts = {};
            gameData.inventory.forEach(fish => {
                fishCounts[fish.name] = (fishCounts[fish.name] || 0) + 1;
            });

            for (let fishName in fishCounts) {
                const fish = gameData.inventory.find(f => f.name === fishName);
                const div = document.createElement('div');
                div.style.display = 'flex';
                div.style.justifyContent = 'space-between';
                div.style.alignItems = 'center';
                div.style.padding = '5px 0';
                div.style.borderBottom = '1px solid #eee';
                
                const fishInfo = document.createElement('span');
                fishInfo.textContent = `${fishName} x${fishCounts[fishName]} (${fish.price}é‡‘å¹£)`;
                div.appendChild(fishInfo);
                
                const sellButton = document.createElement('button');
                sellButton.textContent = 'è³£å‡º';
                sellButton.style.padding = '3px 8px';
                sellButton.style.backgroundColor = '#4CAF50';
                sellButton.style.color = 'white';
                sellButton.style.border = 'none';
                sellButton.style.borderRadius = '3px';
                sellButton.style.cursor = 'pointer';
                sellButton.onclick = () => sellFish(fishName);
                div.appendChild(sellButton);
                
                inventoryList.appendChild(div);
            }
        }

        // è³£å‡ºé­š
        function sellFish(fishName) {
            // ä½¿ç”¨å¸¶æœ‰è½‰ç›¤éŠæˆ²åŠŸèƒ½çš„å‡½æ•¸
            sellFishWithWheel(fishName);
            
            // è‡ªå‹•ä¿å­˜éŠæˆ²
            if (typeof autoSaveGame === 'function') {
                setTimeout(autoSaveGame, 1000); // å»¶é²1ç§’ä¿å­˜ï¼Œç¢ºä¿è½‰ç›¤éŠæˆ²çµæœå·²è™•ç†
            }
        }

        // å•†åº—åŠŸèƒ½
        function openShop() {
            const shopModal = document.getElementById('shopModal');
            const shopItems = document.getElementById('shopItems');
            shopItems.innerHTML = '';

            rods.forEach(rod => {
                if (rod.name !== gameData.currentRod.name) {
                    const div = document.createElement('div');
                    div.style.padding = '10px';
                    div.style.margin = '8px 0';
                    div.style.borderRadius = '5px';
                    div.style.backgroundColor = '#f9f9f9';
                    div.style.display = 'flex';
                    div.style.justifyContent = 'space-between';
                    div.style.alignItems = 'center';
                    
                    const rodInfo = document.createElement('span');
                    rodInfo.innerHTML = `<strong>${rod.name}</strong><br>${rod.price}é‡‘å¹£ (åŠ›é‡: ${rod.power})`;
                    div.appendChild(rodInfo);
                    
                    const buyButton = document.createElement('button');
                    buyButton.textContent = 'è³¼è²·';
                    buyButton.onclick = () => buyRod(rod);
                    buyButton.disabled = gameData.money < rod.price;
                    if (gameData.money < rod.price) {
                        buyButton.style.opacity = '0.5';
                        buyButton.style.cursor = 'not-allowed';
                    }
                    div.appendChild(buyButton);
                    shopItems.appendChild(div);
                }
            });

            shopModal.style.display = 'flex';
            // æ·»åŠ å‹•ç•«æ•ˆæœ
            setTimeout(() => {
                shopModal.classList.add('show');
            }, 10);
        }

        function closeShop() {
            const shopModal = document.getElementById('shopModal');
            shopModal.classList.remove('show');
            // ç­‰å¾…å‹•ç•«å®Œæˆå¾Œéš±è—æ¨¡æ…‹æ¡†
            setTimeout(() => {
                shopModal.style.display = 'none';
            }, 300);
        }

        // è³¼è²·é‡£ç«¿
        function buyRod(rod) {
            if (gameData.money >= rod.price) {
                gameData.money -= rod.price;
                gameData.currentRod = rod;
                document.getElementById('currentRod').textContent = rod.name;
                updateInventory();
                closeShop();
                gameAlert(`æˆåŠŸè³¼è²· ${rod.name}ï¼`, 'success', 'è³¼è²·æˆåŠŸ', 3000);
                
                // è‡ªå‹•ä¿å­˜éŠæˆ²
                if (typeof autoSaveGame === 'function') {
                    autoSaveGame();
                }
            }
        }

        // åœ°åœ–åŠŸèƒ½
        function openMap() {
            const mapModal = document.getElementById('mapModal');
            const mapLocations = document.getElementById('mapLocations');
            mapLocations.innerHTML = '';

            Object.keys(fishes).forEach(location => {
                const div = document.createElement('div');
                div.style.padding = '12px';
                div.style.margin = '8px 0';
                div.style.borderRadius = '8px';
                div.style.cursor = 'pointer';
                div.style.transition = 'all 0.2s ease';
                div.style.boxShadow = '0 1px 3px rgba(0,0,0,0.1)';
                
                // å‰µå»ºä½ç½®åœ–æ¨™
                const locationIcon = document.createElement('span');
                locationIcon.innerHTML = 'ğŸ—ºï¸ ';
                locationIcon.style.marginRight = '8px';
                div.appendChild(locationIcon);
                
                // å‰µå»ºä½ç½®æ–‡æœ¬
                const locationText = document.createElement('span');
                locationText.textContent = location;
                div.appendChild(locationText);
                
                // æ·»åŠ å‚³é€è²»ç”¨æ¨™ç±¤
                const cost = travelCosts[location] || 0;
                if (cost > 0 && location !== gameData.currentLocation) {
                    const costTag = document.createElement('span');
                    costTag.textContent = ` (${cost} é‡‘å¹£)`;
                    costTag.style.color = gameData.money >= cost ? '#4CAF50' : '#f44336';
                    costTag.style.fontWeight = 'bold';
                    locationText.appendChild(costTag);
                }
                
                if (location === gameData.currentLocation) {
                    div.style.fontWeight = 'bold';
                    div.style.backgroundColor = '#e0f7fa';
                    div.style.borderLeft = '4px solid #2e8cb8';
                    
                    const currentTag = document.createElement('span');
                    currentTag.textContent = ' (ç•¶å‰ä½ç½®)';
                    currentTag.style.color = '#2e8cb8';
                    locationText.appendChild(currentTag);
                }
                
                // æ·»åŠ é­šé¡ä¿¡æ¯æç¤º
                const fishInfo = document.createElement('div');
                fishInfo.style.fontSize = '0.8em';
                fishInfo.style.color = '#666';
                fishInfo.style.marginTop = '5px';
                fishInfo.style.marginLeft = '25px';
                
                const locationFishes = fishes[location];
                fishInfo.textContent = `å¯é‡£åˆ°: ${locationFishes.map(f => f.name).join(', ')}`;
                div.appendChild(fishInfo);
                
                div.onclick = () => changeLocation(location);
                div.addEventListener('mouseover', () => {
                    div.style.backgroundColor = location === gameData.currentLocation ? '#b2ebf2' : '#f5f5f5';
                    div.style.transform = 'translateY(-2px)';
                    div.style.boxShadow = '0 4px 6px rgba(0,0,0,0.1)';
                });
                div.addEventListener('mouseout', () => {
                    div.style.backgroundColor = location === gameData.currentLocation ? '#e0f7fa' : '';
                    div.style.transform = 'translateY(0)';
                    div.style.boxShadow = '0 1px 3px rgba(0,0,0,0.1)';
                });
                
                mapLocations.appendChild(div);
            });

            // æ›´æ–°åœ°åœ–å½ˆçª—ä¸­çš„é‡‘éŒ¢é¡¯ç¤º
            document.getElementById('mapModalMoney').textContent = gameData.money;
            
            mapModal.style.display = 'flex';
            // æ·»åŠ å‹•ç•«æ•ˆæœ
            setTimeout(() => {
                mapModal.classList.add('show');
            }, 10);
        }

        function closeMap() {
            const mapModal = document.getElementById('mapModal');
            mapModal.classList.remove('show');
            // ç­‰å¾…å‹•ç•«å®Œæˆå¾Œéš±è—æ¨¡æ…‹æ¡†
            setTimeout(() => {
                mapModal.style.display = 'none';
            }, 300);
        }

        // æ›´æ›é‡£é­šåœ°é»
        function changeLocation(location) {
            if (location === gameData.currentLocation) {
                gameAlert(`ä½ å·²ç¶“åœ¨ ${location} äº†ï¼`, 'info', 'åœ°é»æç¤º', 2000);
                closeMap();
                return;
            }
            
            // æª¢æŸ¥å‚³é€è²»ç”¨
            const cost = travelCosts[location] || 0;
            if (cost > 0) {
                // æª¢æŸ¥ç©å®¶æ˜¯å¦æœ‰è¶³å¤ çš„é‡‘éŒ¢
                if (gameData.money < cost) {
                    gameAlert(`å‰å¾€ ${location} éœ€è¦ ${cost} é‡‘å¹£ï¼Œä½†ä½ åªæœ‰ ${gameData.money} é‡‘å¹£ï¼`, 'error', 'é‡‘éŒ¢ä¸è¶³', 3000);
                    closeMap();
                    return;
                }
                
                // æ‰£é™¤å‚³é€è²»ç”¨
                gameData.money -= cost;
                // æ›´æ–°é‡‘éŒ¢é¡¯ç¤º
                document.getElementById('money').textContent = gameData.money;
                gameAlert(`å·²æ”¯ä»˜ ${cost} é‡‘å¹£å‰å¾€ ${location}ï¼`, 'info', 'è²»ç”¨æ”¯ä»˜', 2000);
            }
            
            gameData.currentLocation = location;
            closeMap();
            
            // æ›´æ–°UIé¡¯ç¤ºç•¶å‰ä½ç½®
            const locationDisplay = document.createElement('div');
            locationDisplay.textContent = `ç•¶å‰ä½ç½®: ${location}`;
            locationDisplay.style.position = 'absolute';
            locationDisplay.style.top = '10px';
            locationDisplay.style.left = '10px';
            locationDisplay.style.backgroundColor = 'rgba(255, 255, 255, 0.7)';
            locationDisplay.style.padding = '5px 10px';
            locationDisplay.style.borderRadius = '5px';
            locationDisplay.style.zIndex = '10';
            locationDisplay.id = 'locationDisplay';
            
            // ç§»é™¤èˆŠçš„ä½ç½®é¡¯ç¤ºï¼ˆå¦‚æœæœ‰ï¼‰
            const oldLocationDisplay = document.getElementById('locationDisplay');
            if (oldLocationDisplay) {
                oldLocationDisplay.remove();
            }
            
            document.getElementById('fishingSpot').appendChild(locationDisplay);
            gameAlert(`å·²ç§»å‹•åˆ° ${location}ï¼`, 'success', 'ç§»å‹•æˆåŠŸ', 3000);
            
            // è‡ªå‹•ä¿å­˜éŠæˆ²
            if (typeof autoSaveGame === 'function') {
                autoSaveGame();
            }
        }

        // åˆå§‹åŒ–éŠæˆ²
        function initGame() {
            updateInventory();
            
            // åˆå§‹åŒ–é¡¯ç¤ºç•¶å‰ä½ç½®
            const locationDisplay = document.createElement('div');
            locationDisplay.textContent = `ç•¶å‰ä½ç½®: ${gameData.currentLocation}`;
            locationDisplay.style.position = 'absolute';
            locationDisplay.style.top = '10px';
            locationDisplay.style.left = '10px';
            locationDisplay.style.backgroundColor = 'rgba(255, 255, 255, 0.7)';
            locationDisplay.style.padding = '5px 10px';
            locationDisplay.style.borderRadius = '5px';
            locationDisplay.style.zIndex = '10';
            locationDisplay.id = 'locationDisplay';
            document.getElementById('fishingSpot').appendChild(locationDisplay);
            
            // æ·»åŠ ç‰ˆæœ¬è™Ÿé¡¯ç¤º
            const versionDisplay = document.createElement('div');
            versionDisplay.textContent = `${gameData.version}`;
            versionDisplay.style.position = 'fixed';
            versionDisplay.style.bottom = '10px';
            versionDisplay.style.right = '10px';
            versionDisplay.style.backgroundColor = 'rgba(255, 255, 255, 0.7)';
            versionDisplay.style.padding = '5px 10px';
            versionDisplay.style.borderRadius = '5px';
            versionDisplay.style.fontSize = '12px';
            versionDisplay.style.color = '#666';
            versionDisplay.style.zIndex = '1000';
            versionDisplay.id = 'versionDisplay';
            document.body.appendChild(versionDisplay);
        }
        
        // å•Ÿå‹•éŠæˆ²
        initGame();
    </script>
    
    <!-- å¼•å…¥è½‰ç›¤éŠæˆ²JSæ–‡ä»¶ -->
    <script src="wheel_game.js"></script>
    <!-- å¼•å…¥é€šçŸ¥ç³»çµ±JSæ–‡ä»¶ -->
    <script src="notification.js"></script>
    <!-- å¼•å…¥å­˜æª”ç³»çµ±JSæ–‡ä»¶ -->
    <script src="save_system.js"></script>
    
    <script>
        // åœ¨é é¢åŠ è¼‰å®Œæˆå¾Œï¼Œåˆå§‹åŒ–éŠæˆ²
        window.onload = function() {
            // æ›´æ–°èƒŒåŒ…ä¸­çš„è³£å‡ºæŒ‰éˆ•ï¼Œä½¿ç”¨å¸¶æœ‰è½‰ç›¤éŠæˆ²çš„å‡½æ•¸
            updateInventory();
            
            // åˆå§‹åŒ–å­˜æª”ç³»çµ±
            if (typeof initSaveSystem === 'function') {
                initSaveSystem();
            }
        }
    </script>
    
    <!-- ç‰ˆæ¬Šä¿¡æ¯ -->
    <div style="position: fixed; bottom: 10px; left: 10px; background-color: rgba(0, 0, 0, 0.5); color: white; padding: 5px 10px; border-radius: 5px; font-size: 12px; z-index: 1000;">
        Â© sarguastudio
    </div>
</body>
</html>